(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{349:function(t,e,n){var r=n(3);t.exports=r(1..valueOf)},350:function(t,e,n){var content=n(466);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(105).default)("0e6ca180",content,!0,{sourceMap:!1})},400:function(t,e,n){"use strict";var r=n(4),o=n(0),c=n(3),l=n(51),f=n(349),d=n(185),m=n(6),h=o.RangeError,v=o.String,_=Math.floor,k=c(d),y=c("".slice),x=c(1..toFixed),w=function(t,e,n){return 0===e?n:e%2==1?w(t,e-1,n*t):w(t*t,e/2,n)},I=function(data,t,e){for(var n=-1,r=e;++n<6;)r+=t*data[n],data[n]=r%1e7,r=_(r/1e7)},S=function(data,t){for(var e=6,n=0;--e>=0;)n+=data[e],data[e]=_(n/t),n=n%t*1e7},T=function(data){for(var t=6,s="";--t>=0;)if(""!==s||0===t||0!==data[t]){var e=v(data[t]);s=""===s?e:s+k("0",7-e.length)+e}return s};r({target:"Number",proto:!0,forced:m((function(){return"0.000"!==x(8e-5,3)||"1"!==x(.9,0)||"1.25"!==x(1.255,2)||"1000000000000000128"!==x(0xde0b6b3a7640080,0)}))||!m((function(){x({})}))},{toFixed:function(t){var e,n,r,o,c=f(this),d=l(t),data=[0,0,0,0,0,0],m="",_="0";if(d<0||d>20)throw h("Incorrect fraction digits");if(c!=c)return"NaN";if(c<=-1e21||c>=1e21)return v(c);if(c<0&&(m="-",c=-c),c>1e-21)if(n=(e=function(t){for(var e=0,n=t;n>=4096;)e+=12,n/=4096;for(;n>=2;)e+=1,n/=2;return e}(c*w(2,69,1))-69)<0?c*w(2,-e,1):c/w(2,e,1),n*=4503599627370496,(e=52-e)>0){for(I(data,0,n),r=d;r>=7;)I(data,1e7,0),r-=7;for(I(data,w(10,r,1),0),r=e-1;r>=23;)S(data,1<<23),r-=23;S(data,1<<r),I(data,1,1),S(data,2),_=T(data)}else I(data,0,n),I(data,1<<-e,0),_=T(data)+k("0",d);return _=d>0?m+((o=_.length)<=d?"0."+k("0",d-o)+_:y(_,0,o-d)+"."+y(_,o-d)):m+_}})},459:function(t,e,n){"use strict";var r=n(13),o=n(0),c=n(3),l=n(107),f=n(18),d=n(14),m=n(188),h=n(45),v=n(106),_=n(187),k=n(6),y=n(75).f,x=n(37).f,w=n(16).f,I=n(349),S=n(460).trim,T="Number",C=o.Number,N=C.prototype,E=o.TypeError,A=c("".slice),R=c("".charCodeAt),F=function(t){var e=_(t,"number");return"bigint"==typeof e?e:B(e)},B=function(t){var e,n,r,o,c,l,f,code,d=_(t,"number");if(v(d))throw E("Cannot convert a Symbol value to a number");if("string"==typeof d&&d.length>2)if(d=S(d),43===(e=R(d,0))||45===e){if(88===(n=R(d,2))||120===n)return NaN}else if(48===e){switch(R(d,1)){case 66:case 98:r=2,o=49;break;case 79:case 111:r=8,o=55;break;default:return+d}for(l=(c=A(d,2)).length,f=0;f<l;f++)if((code=R(c,f))<48||code>o)return NaN;return parseInt(c,r)}return+d};if(l(T,!C(" 0o1")||!C("0b1")||C("+0x1"))){for(var O,j=function(t){var e=arguments.length<1?0:C(F(t)),n=this;return h(N,n)&&k((function(){I(n)}))?m(Object(e),n,j):e},M=r?y(C):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),z=0;M.length>z;z++)d(C,O=M[z])&&!d(j,O)&&w(j,O,x(C,O));j.prototype=N,N.constructor=j,f(o,T,j)}},460:function(t,e,n){var r=n(3),o=n(24),c=n(12),l=n(461),f=r("".replace),d="["+l+"]",m=RegExp("^"+d+d+"*"),h=RegExp(d+d+"*$"),v=function(t){return function(e){var n=c(o(e));return 1&t&&(n=f(n,m,"")),2&t&&(n=f(n,h,"")),n}};t.exports={start:v(1),end:v(2),trim:v(3)}},461:function(t,e){t.exports="\t\n\v\f\r Â áš€â€€â€â€‚â€ƒâ€„â€…â€†â€‡â€ˆâ€‰â€Šâ€¯âŸã€€\u2028\u2029\ufeff"},462:function(t,e,n){"use strict";var r=n(4),o=n(463).end;r({target:"String",proto:!0,forced:n(464)},{padEnd:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}})},463:function(t,e,n){var r=n(3),o=n(52),c=n(12),l=n(185),f=n(24),d=r(l),m=r("".slice),h=Math.ceil,v=function(t){return function(e,n,r){var l,v,_=c(f(e)),k=o(n),y=_.length,x=void 0===r?" ":c(r);return k<=y||""==x?_:((v=d(x,h((l=k-y)/x.length))).length>l&&(v=m(v,0,l)),t?_+v:v+_)}};t.exports={start:v(!1),end:v(!0)}},464:function(t,e,n){var r=n(60);t.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(r)},465:function(t,e,n){"use strict";n(350)},466:function(t,e,n){var r=n(104)(!1);r.push([t.i,"\ntable, td {\n    vertical-align: middle !important;\n    text-align: left !important;\n}\n",""]),t.exports=r},471:function(t,e,n){"use strict";n.r(e);n(36),n(31),n(38),n(23),n(26),n(35),n(39),n(22);var r=n(9);n(11),n(76),n(400),n(459),n(25),n(135),n(74),n(189),n(462),n(44);function o(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,f=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return l=t.done,t},e:function(t){f=!0,o=t},f:function(){try{l||null==n.return||n.return()}finally{if(f)throw o}}}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var l=n(2).a.extend({props:["account","effectsdk"],data:function(){return{campaign:null,clientId:"d6dd66c7d97349e1bf930eac35962903",clientSecret:"da865f7bf82c4e6098836c5124800e52",token:null,currentTrack:null,tracks:[],campaignId:19,makeBatchSuccess:null,repetitions:1,batchId:null,loading:!1,error:null}},mounted:function(){this.getCampaign()},components:{},methods:{searchTrack:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(""===t.target.value){n.next=8;break}return n.next=3,e.getToken();case 3:return e.token=n.sent,n.next=6,e.getTracks(e.token,t.target.value);case 6:r=n.sent,e.currentTrack=r[0];case 8:case"end":return n.stop()}}),n)})))()},getToken:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Basic "+btoa(t.clientId+":"+t.clientSecret)},body:"grant_type=client_credentials"});case 2:return n=e.sent,e.next=5,n.json();case 5:return data=e.sent,e.abrupt("return",data.access_token);case 7:case"end":return e.stop()}}),e)})))()},getTracks:function(t,filter){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return 10,t.next=3,fetch("https://api.spotify.com/v1/search?type=track&limit=".concat(10,"&q=").concat(filter),{method:"GET",headers:{Authorization:"Bearer "+e.token}});case 3:return n=t.sent,t.next=6,n.json();case 6:return data=t.sent,t.abrupt("return",data.tracks.items);case 8:case"end":return t.stop()}}),t)})))()},addToBatch:function(){this.tracks.push(this.currentTrack),this.currentTrack=null},makeBatch:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r,c,l,track,content,f,d,m,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t.error=null,t.loading=!0,n=t.campaignId,console.log("Campaign ðŸš’:\n".concat(n)),r=[],c=o(t.tracks);try{for(c.s();!(l=c.n()).done;)track=l.value,r.push({song_embed:"https://open.spotify.com/embed/track/".concat(track.id,"?utm_source=generator")})}catch(t){c.e(t)}finally{c.f()}return content={tasks:r},e.next=11,t.effectsdk.force.createBatch(parseInt(n),content,t.repetitions,"efxtaskproxy");case 11:return f=e.sent,d=parseFloat(5*parseFloat(t.campaign.info.reward*r.length*parseInt(t.repetitions))/100).toFixed(2),m={account:t.effectsdk.config.efxTokenContract,name:"transfer",authorization:[{actor:t.account.accountName,permission:t.account.permission}],data:{from:t.account.accountName,to:"fabriziasant",quantity:t.convertToAsset(d)+" "+t.effectsdk.config.efxSymbol,memo:"Fee Vibelyze"}},e.next=16,t.effectsdk.force.sendTransaction(t.account.accountName,m);case 16:return f.campaignId=parseInt(n),e.next=19,t.effectsdk.force.getCampaign(n);case 19:return h=e.sent,f.campaign=h,console.log("add this to store",f),e.next=24,t.effectsdk.force.getBatchId(f.id,n);case 24:t.batchId=e.sent,t.$store.dispatch("batch/addBatch",f),t.makeBatchSuccess=f.transaction,t.loading=!1,e.next=35;break;case 30:e.prev=30,e.t0=e.catch(0),t.loading=!1,t.error=e.t0,console.error(e.t0);case 35:case"end":return e.stop()}}),e,null,[[0,30]])})))()},getCampaign:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("this.campaignId",t.campaignId),e.next=3,t.effectsdk.force.getCampaign(t.campaignId);case 3:t.campaign=e.sent,console.log("this.campaign",t.campaign);case 5:case"end":return e.stop()}}),e)})))()},convertToAsset:function(t){try{if(Number(t)<0)throw new Error("Amount must be positive");var e=t.toString().split(".");if(1===e.length)return"".concat(e[0],".").concat("0".repeat(4));if(e[1].length>4)return"".concat(e[0],".").concat(e[1].substring(0,4));e[1].length;return"".concat(e[0],".").concat(e[1].padEnd(4,"0"))}catch(t){throw Error(t)}}}}),f=(n(465),n(50)),component=Object(f.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.error?n("article",{staticClass:"message is-danger"},[n("div",{staticClass:"message-body"},[t._v("\n    "+t._s(t.error)+"\n  ")])]):t._e(),t._v(" "),n("h1",{staticClass:"title mt-5",staticStyle:{"text-align":"center"}},[t._v("\n      Create your batch of songs\n    ")]),t._v(" "),n("form",{attrs:{action:"#",onsubmit:"return false"}},[n("div",{staticClass:"field"},[n("input",{staticClass:"input",attrs:{autocomplete:"off",type:"text",name:"song",placeholder:"Search for a song.."},on:{change:t.searchTrack}})])]),t._v(" "),n("div",[t.currentTrack?n("div",{staticClass:"has-text-centered"},[n("div",{staticClass:"mt-5"},[n("img",{staticClass:"mb-2",staticStyle:{margin:"0 auto",width:"200px"},attrs:{src:t.currentTrack.album.images[1].url,alt:""}})]),t._v(" "),n("div",[n("label",{staticClass:"form-label",attrs:{for:"Genre"}},[t._v(t._s(t.currentTrack.name))])]),t._v(" "),n("div",{staticClass:"mb-2"},[n("label",{staticClass:"form-label",attrs:{for:"artist"}},[t._v("by "+t._s(t.currentTrack.artists[0].name))])]),t._v(" "),n("button",{staticClass:"button is-primary is-outlined mt-3",on:{click:function(e){return t.addToBatch()}}},[t._v("Add Song")])]):t._e()]),t._v(" "),t.tracks&&t.tracks.length>0?n("div",{staticClass:"mt-6 is-flex is-flex-direction-column"},[n("h2",{staticClass:"is-4 mb-3 title"},[t._v("Batch")]),t._v(" "),n("table",{staticClass:"table",staticStyle:{width:"100%"}},[t._m(0),t._v(" "),n("tbody",{attrs:{id:"table-body"}},t._l(t.tracks,(function(track){return n("tr",{key:track.name},[n("td",[n("img",{staticStyle:{width:"40px"},attrs:{src:track.album.images[2].url}})]),t._v(" "),n("td",[t._v(t._s(track.name))]),t._v(" "),n("td",[t._v(t._s(track.artists[0].name))])])})),0)]),t._v("\n\n    Amount of people that analyze each song:\n    "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.repetitions,expression:"repetitions"}],staticClass:"input",staticStyle:{width:"135px"},attrs:{name:"Repetitions",min:"1",max:"100",type:"number",placeholder:"Repetitions"},domProps:{value:t.repetitions},on:{input:function(e){e.target.composing||(t.repetitions=e.target.value)}}}),t._v(" "),n("span",[t._v("Total cost: "+t._s(parseFloat(t.campaign.info.reward*t.tracks.length*t.repetitions).toFixed(2))+" EFX*")]),t._v(" "),n("br"),n("br"),t._v(" "),n("button",{staticClass:"button is-primary mt-2 is-align-self-flex-end",class:{"is-loading":t.loading},attrs:{type:"submit"},on:{click:t.makeBatch}},[t._v("Submit Songs")]),t._v(" "),t.batchId?n("div",{staticClass:"notification is-primary is-light mt-5",staticStyle:{"font-size":"23px"}},[t._v("\n      Your songs have been submitted! Check the results here: "),n("nuxt-link",{attrs:{to:"/batch/"+t.batchId}},[t._v("here")])],1):t._e(),t._v(" "),n("span",{staticClass:"is-size-5"},[t._v("\n      *Excluding a 5% fee\n    ")]),t._v(" "),t.makeBatchSuccess?n("a",{attrs:{href:"/results"}},[n("button",{staticClass:"button is-primary is-outlined"},[t._v("Results page")])]):t._e()]):t._e()])}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",[n("tr",[n("th"),t._v(" "),n("th",[t._v("Title")]),t._v(" "),n("th",[t._v("Artist")])])])}],!1,null,null,null);e.default=component.exports}}]);